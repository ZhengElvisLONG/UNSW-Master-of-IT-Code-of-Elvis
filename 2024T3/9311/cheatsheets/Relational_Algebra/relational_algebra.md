### 例题描述
我们有以下四个关系：

1. **学生 (Student)**
   ```
   学生ID   姓名     年龄
   ----    ----    ----
   1       张三     20
   2       李四     21
   3       王五     20
   4       赵六     22
   ```

2. **课程 (Course)**
   ```
   课程ID   课程名
   ----    ----
   101     数学
   102     物理
   103     化学
   ```

3. **选课 (Enrolment)**
   ```
   学生ID   课程ID   成绩
   ----    ----    ----
   1       101     85
   1       102     90
   2       101     78
   3       103     88
   4       102     82
   4       101     95
   ```

4. **导师 (Advisor)**
   ```
   导师ID   导师名     学生ID
   ----    ----      ----
   201     陈教授     1
   202     王教授     2
   203     李教授     3
   201     陈教授     4
   ```

### 要求和操作
通过这些关系，回答以下复杂的问题，尽量综合使用各种运算。

#### 1. 找出所有学生及其所选课程的详细信息，并显示学生的导师姓名
##### 运算步骤：
- **连接操作 (JOIN)**：
  1. 首先通过 `学生` 和 `选课` 关系进行连接，找出学生的选课信息。
     ```
     Student ⋈(学生ID=学生ID) Enrolment
     ```
  2. 再将上一步的结果与 `课程` 关系进行连接，得到课程名。
     ```
     (Student ⋈ Enrolment) ⋈(课程ID=课程ID) Course
     ```
  3. 最后，再与 `导师` 关系连接，得到每个学生的导师信息。
     ```
     ((Student ⋈ Enrolment) ⋈ Course) ⋈(学生ID=学生ID) Advisor
     ```
- **结果**：
  ```
  学生ID   姓名   年龄   课程ID   课程名   成绩   导师ID   导师名
  ----    ----  ----  ----    ----   ----   ----   ----
  1       张三   20     101     数学    85     201    陈教授
  1       张三   20     102     物理    90     201    陈教授
  2       李四   21     101     数学    78     202    王教授
  3       王五   20     103     化学    88     203    李教授
  4       赵六   22     102     物理    82     201    陈教授
  4       赵六   22     101     数学    95     201    陈教授
  ```

#### 2. 找出平均年龄超过 20 岁的导师所指导的学生名单
##### 运算步骤：
1. **选择操作 (SELECT)**：
   - 首先选择所有**年龄超过 20** 的学生。
     ```
     𝜎(年龄 > 20)(Student)
     ```
2. **连接操作 (JOIN)**：
   - 将上一步的结果与 `导师` 关系进行连接，以找到这些学生的导师信息。
     ```
     𝜎(年龄 > 20)(Student) ⋈(学生ID=学生ID) Advisor
     ```
3. **投影操作 (PROJECT)**：
   - 投影出导师的名字和学生的姓名。
     ```
     𝜋(导师名, 姓名)(𝜎(年龄 > 20)(Student) ⋈ Advisor)
     ```
- **结果**：
  ```
  导师名    姓名
  ----    ----
  王教授    李四
  陈教授    赵六
  ```

#### 3. 找出所有学生的课程成绩及其对应导师，且只保留与所有课程都有关的学生
##### 运算步骤：
1. **连接操作 (JOIN)**：
   - 首先将 `选课` 和 `课程` 进行连接，以便得到学生选修的课程名称。
     ```
     Enrolment ⋈(课程ID=课程ID) Course
     ```
2. **连接操作 (JOIN)**：
   - 再将上一步结果与 `学生` 关系连接，以便找到每个学生的姓名和成绩。
     ```
     (Enrolment ⋈ Course) ⋈(学生ID=学生ID) Student
     ```
3. **除法操作 (DIVISION)**：
   - 现在我们需要找出那些选修了**所有课程**的学生。将包含所有学生的 `(学生ID, 课程ID)` 投影部分除以包含所有课程的 `课程ID`。
     ```
     𝜋(学生ID, 课程ID)(Enrolment) ÷ 𝜋(课程ID)(Course)
     ```
4. **连接操作 (JOIN)**：
   - 将除法结果中的学生ID与之前的详细连接结果结合，以找到相关详细信息。
     ```
     (𝜋(学生ID, 课程ID)(Enrolment) ÷ 𝜋(课程ID)(Course)) ⋈(学生ID=学生ID) ((Enrolment ⋈ Course) ⋈ Student)
     ```
5. **结果**：
  ```
  学生ID   姓名   课程ID   课程名   成绩
  ----    ----  ----    ----   ----
  1       张三   101     数学    85
  1       张三   102     物理    90
  4       赵六   101     数学    95
  4       赵六   102     物理    82
  ```

#### 4. 统计每个导师所指导学生的平均成绩
##### 运算步骤：
1. **连接操作 (JOIN)**：
   - 将 `导师` 和 `选课` 连接，以获得每个学生及其课程成绩，以及导师信息。
     ```
     Advisor ⋈(学生ID=学生ID) Enrolment
     ```
2. **聚合操作 (AGGREGATE)**：
   - 使用聚合操作计算每个导师所指导学生的**平均成绩**。
     ```
     γ(导师名, AVG(成绩))(Advisor ⋈ Enrolment)
     ```
3. **结果**：
   ```
   导师名    平均成绩
   ----    ----
   陈教授    88
   王教授    78
   李教授    88
   ```

### 总结
通过以上的例子，我们用到了几乎所有关系代数的主要操作：
- **选择 (SELECT)** 用于从关系中筛选符合条件的元组。
- **投影 (PROJECT)** 用于从关系中选择特定属性。
- **并集、交集、差集** 用于处理集合之间的数据操作。
- **笛卡尔积 (CARTESIAN PRODUCT)** 和 **连接 (JOIN)** 用于合并不同关系中的相关数据。
- **除法 (DIVISION)** 用于找出满足所有子集条件的数据。
- **重命名 (RENAME)** 可以用于消除属性名称上的歧义。
- **聚合 (AGGREGATE)** 用于计算统计信息，如平均值、总和等。

这些运算结合起来，帮助我们解决复杂的数据查询和分析问题。